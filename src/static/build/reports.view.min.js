define(["jquery","bootstrap","exif-reader","queryString"],function(e,t,a,o){"use strict";function r(t,a,o){var r=e("#image-exif"),n=EXIF.getTag(t,a);return r.append(`<dl><dt>${o||a}</dt><dd>${void 0!=n?n:"N/A"}</dd></dl>`),n}function n(e){return`${e[0]}.${e[1]}${(e[2]+"").replace(".","")}`}function i(){if(""!=e(this).attr("src")){var t=e(this)[0];e("#image-preview")[0].appendChild(t),e("#image-preview > img").attr("width","100%");var a=e("#image-exif");a.html(""),EXIF.getData(t,function(){r(t,"DateTimeOriginal","Дата создания"),r(t,"Orientation","Ориентация");var o=r(t,"GPSLatitude","Широта"),i=r(t,"GPSLongitude","Долгота");o=n(o),i=n(i),e.get(`https://geocode-maps.yandex.ru/1.x/?geocode=${o},${i}&sco=latlong&format=json`,function(e){if(void 0!=e&&null!=e&&e.response.GeoObjectCollection.metaDataProperty.GeocoderResponseMetaData.found>0){var t=`https://yandex.ru/maps/?ll=${i}%2C${o}&z=12`,r=e.response.GeoObjectCollection.featureMember[0].GeoObject.metaDataProperty.GeocoderMetaData.text;a.append(`<dl><dt>Адрес</dt><dd><a href="${t}" target="_blank">${r}</a></dd></dl>`)}})})}}e(document).ready(function(){e(".js-view-photo").click(function(t){e("#image-preview").html("");var a=e(this).data("source"),o=new Image;o.onload=i,o.src=a,e("#myModal").modal("toggle")}),e(".js-selector").change(function(t){var a=e(t.target),r=a.attr("name"),n=a.val();window.location.href=o.generateQueryString(window.location.href,r,n,"reports")})})});